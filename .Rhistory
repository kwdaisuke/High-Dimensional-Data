f.svm = svm(X, Y, kernel = 'radial', gamma = 1, type = 'C-classification')
ystar = predict(f.svm, matrix(xstar, nrow=1))
ystar
rep(10, 10)
rep(10, 2)
V = 25 ; GAMMA = seq(0.01, 1, by=0.01) # GAMMA is always smaller than 1
n = nrow(X)
fold = rep(1:V, n/V)
err.svm = matrix(NA, K, V)
for (v in 1:V){
learn = which(fold !=v)
test = which(fold == v)
for (j in 1:length(GAMMA)){
gamma = GAMMA[j]
f.svm = svm(X[learn,], Y[learn], kernel = 'radial', gamma-gamma,
type = "C-classification")
ystar = predict(f.svm, X[test,])
err.svm[j,v] = sum(ystar != Y[test]) / length(ystar)  }
}
V = 25 ; GAMMA = seq(0.01, 1, by=0.01) # GAMMA is always smaller than 1
n = nrow(X)
fold = rep(1:V, n/V)
err.svm = matrix(NA, K, V)
for (v in 1:V){
learn = which(fold !=v)
test = which(fold == v)
for (j in 1:length(GAMMA)){
gamma = GAMMA[j]
f.svm = svm(X[learn,], Y[learn], kernel = 'radial', gamma-gamma,
type = "C-classification")
ystar = predict(f.svm, X[test,])
err.svm[j,v] = sum(ystar != Y[test]) / length(ystar)  }
}
V = 25 ; GAMMA = seq(0.01, 1, by=0.01) # GAMMA is always smaller than 1
n = nrow(X)
fold = rep(1:V, n/V)
err.svm = matrix(NA, length(GAMMA), V)
for (v in 1:V){
learn = which(fold !=v)
test = which(fold == v)
for (j in 1:length(GAMMA)){
gamma = GAMMA[j]
f.svm = svm(X[learn,], Y[learn], kernel = 'radial', gamma-gamma,
type = "C-classification")
ystar = predict(f.svm, X[test,])
err.svm[j,v] = sum(ystar != Y[test]) / length(ystar)
}
}
plot(GAMMA, rowMeans(err.svm), type='b')
V = 25 ; GAMMA = seq(0.01, 1, by=0.01) # GAMMA is always smaller than 1
n = nrow(X)
fold = rep(1:V, n/V)
err.svm = matrix(NA, length(GAMMA), V)
for (v in 1:V){
learn = which(fold != v)
test = which(fold == v)
for (j in 1:length(GAMMA)){
gamma = GAMMA[j]
f.svm = svm(X[learn,], Y[learn], kernel = 'radial', gamma-gamma,
type = "C-classification")
ystar = predict(f.svm, X[test,])
err.svm[j,v] = sum(ystar != Y[test]) / length(ystar)
}
}
plot(GAMMA, rowMeans(err.svm), type='b')
V = 25 ; GAMMA = seq(0.01, 1, by=0.01) # GAMMA is always smaller than 1
n = nrow(X)
fold = rep(1:V, n/V)
err.svm = matrix(NA, length(GAMMA), V)
for (v in 1:V){
learn = which(fold != v)
test = which(fold == v)
for (j in 1:length(GAMMA)){
gamma = GAMMA[j]
f.svm = svm(X[learn,], Y[learn], kernel = 'radial', gamma-gamma,
type = "C-classification")
ystar = predict(f.svm, X[test,])
err.svm[j,v] = sum(ystar != Y[test]) / length(ystar)
}
}
plot(GAMMA, rowMeans(err.svm), type='b')
which(c(1,2,3,4,5,6,7,8,9,10))
data(iris)
X = iris[,-5]
Y = as.numeric(iris$Species)
pca = princomp(X)
bplot(pca)
data(iris)
X = iris[,-5]
Y = as.numeric(iris$Species)
pca = princomp(X)
biplot(pca)
data("AirPassengers")
str(AirPassengers)
varicelle<-ts(data$x, start=c(1931, 1), end=c(1972, 6), freq=12)
plot(varicelle)
data = read.csv()
#install.packages("depmixS4")
library("depmixS4")
#install.packages("quantmod")
library("quantmod")
setwd("/Users/emisohpi/Desktop/DataFluct/アズビル")
df <- read.csv("cleaned.csv")
date <- as.character(df[,1])
date_TS<- as.POSIXlt(date) # Create date and time objects
TSData <- data.frame(df[,2], row.names=date_TS)
TSData <- as.xts(TSData) # Build our time series dataset
colnames(TSData) <- "pulse"
HMM <- depmix(list(pulse~1), data=TSData, nstates=20, family=list(poisson()))
setwd("/Users/emisohpi/Desktop/DSTI/TimeSeries")
setwd("/Users/emisohpi/Desktop/DSTI/TimeSeries")
setwd("/Users/emisohpi/Desktop/DSTI/TimeSeries")
setwd("/Users/emisohpi/Desktop/DSTI/TimeSeries")
setwd("/Users/emisohpi/Desktop/DSTI/")
setwd("/Users/emisohpi/Desktop/DSTI")
setwd("/Users/emisohpi/Desktop/DSTI/TimeSeries")
setwd("/Users/emisohpi/Desktop/DSTI/TimeSeries")
setwd("/Users/emisohpi/Desktop/DSTI")
setwd("/Users/emisohpi/Desktop/DSTI/TimeSeries")
setwd("/Users/emisohpi/Desktop/DSTI/TimeSeries")
setwd("/Users/emisohpi/Desktop/DSTI/TimeSeries")
elec_train = window(elecdaily, start=c(1,1), end=c(52,4))
data(elecdaily)
autoplot(elecdaily)
data(elecdaily)
autoplot(elecdaily)
data(elecdaily)
autoplot(elecdaily)
data(elecdaily)
autoplot(elecdaily)
library(fpp2)
data(elecdaily)
autoplot(elecdaily)
elec_train = window(elecdaily, start=c(1,1), end=c(52,4))
elec_test=window(elecdaily, start=c(52, 5), end=c(53,4))
temp = elecdaily[,"Temperature"]
elec_train = window(elecdaily, start=c(1,1), end=c(52,4))
elec_test=window(elecdaily, start=c(52, 5), end=c(53,4))
elec_train
elec_train = window(elecdaily, start=c(1,1), end=c(52,4))
elec_test=window(elecdaily, start=c(52, 5), end=c(53,4))
elec_train$Temperature
elec_train = window(elecdaily, start=c(1,1), end=c(52,4))
elec_test=window(elecdaily, start=c(52, 5), end=c(53,4))
elec_train[,"Temperature"]
elec_train = window(elecdaily, start=c(1,1), end=c(52,4))
elec_test=window(elecdaily, start=c(52, 5), end=c(53,4))
autoplot(elec_train[,"Temperature"])
elec_train = window(elecdaily, start=c(1,1), end=c(52,4))
elec_test=window(elecdaily, start=c(52, 5), end=c(53,4))
autoplot(elec_train[,"Temperature"]) + autolayer(elec_test[,"Temperature"])
elec_train
temp_train = elec_train[,"Temperature"]
checkresiduals(temp_train)
elec_train
library(fpp)
library(fpp2)
data(usconsumption)
plot(usconsumption)
library(fpp2)
data(usconsumption)
plot(usconsumption)
library(fpp2)
data(usconsumption)
autoplot(usconsumption)
usconsumption
install.packages("fpp")
library(fpp)
library(fpp2)
data(usconsumption)
autoplot(usconsumption)
instakk.package("vars")
install.packages("vars")
library(vars)
VRselect(usconsumption, lag.max=8, type="const",season=4)
#install.packages("vars")
#library(vars)
VARselect(usconsumption, lag.max=8, type="const",season=4)
var<-VAR(usconsumption, p=5, )
summary(var)
serial.test(var, lags.pt=10, type"PT.")
fcst <-forecast(var, h=8)
plot(fcst, xlab="Year")
us_app=ts(usconsumption[1:156,], start=c(1970,1), end=c(2008,4), frequency=4)
us_test=ts(usconsumption[157:164,], start=c(2009,1), end=c(2010,4), frequency=4)
fcst<-forecast(var, h=8)
plot(fcst)
library("Metrics")
rmse(us_test[,1]-fcst$forecast$consumption$mean)
library("Metrics")
rmse(us_test[,1], fcst$forecast$consumption$mean)
fcst$forecast$consumption$mean
us_test[,1]
us_test[,1]
library("Metrics")
rmse(us_test[,1], fcst$forecast$consumption$mean)
rmse(us_test[,2], fcst$forecast$income$mean)
install.packages("fpp")
library(fpp)
library(fpp2)
data(usconsumption)
autoplot(usconsumption)
#install.packages("vars")
#library(vars)
VARselect(usconsumption, lag.max=8, type="const",season=4)
var<-VAR(usconsumption, p=5, )
summary(var)
fcst <-forecast(var, h=8)
plot(fcst, xlab="Year")
us_app=ts(usconsumption[1:156,], start=c(1970,1), end=c(2008,4), frequency=4)
us_test=ts(usconsumption[157:164,], start=c(2009,1), end=c(2010,4), frequency=4)
var<-VAR(us_app, p=5, type="const")
serial.test(var, lags.pt=10, type="PT,s¥asymptotic")
mod1=auto.arima(us_app[,1])pred1=forecast(mod1,h =8)mod2=auto.arima(us_app[,2])pred2=forecast(mod2,h =8)print(sqrt(mean(us_test[,1]-pred1$mean)^2))
mod1=auto.arima(us_app[,1])pred1=forecast(mod1,h =8)
mod1=auto.arima(us_app[,1])
pred1=forecast(mod1,h =8)
mod2=auto.arima(us_app[,2])
pred2=forecast(mod2,h =8)
print(sqrt(mean(us_test[,1]-pred1$mean)^2))
rmse(us_test[,2], pred$mean)
mod1=auto.arima(us_app[,1])
pred1=forecast(mod1,h =8)
mod2=auto.arima(us_app[,2])
pred2=forecast(mod2,h =8)
print(sqrt(mean(us_test[,1]-pred1$mean)^2))
rmse(us_test[,2], pred1$mean)
mod1=auto.arima(us_app[,1])
pred1=forecast(mod1,h =8)
mod2=auto.arima(us_app[,2])
pred2=forecast(mod2,h =8)
print(sqrt(mean(us_test[,1]-pred1$mean)^2))
rmse(us_test[,1], pred1$mean)
rmse(us_test[,2], pred2$mean)
usconsumption
var<-VAR(usconsumption, p=5, )
summary(var)
us_app=ts(usconsumption[1:156,], start=c(1970,1), end=c(2008,4), frequency=4)
us_test=ts(usconsumption[157:164,], start=c(2009,1), end=c(2010,4), frequency=4)
var<-VAR(us_app, p=5, type="const")
serial.test(var, lags.pt=10, type="PT,s¥asymptotic")
var<-VAR(us_app, p=5, type="const")
serial.test(var, lags.pt=10, type="PT,sasymptotic")
var<-VAR(us_app, p=5, type="const")
serial.test(var, lags.pt=10, type="PT,asymptotic")
var<-VAR(us_app, p=5, type="const")
serial.test(var, lags.pt=10, type="PT.asymptotic")
usconsumption
uschange
```{r}
```{r}
uschange_train = window(uschange_train, start=c(1970), end=c(2015))
uschange_train = window(uschange, start=c(1970), end=c(2015))
uschange_train
uschange_test = window(uschange, start=c(2016))
uschange_test
library(vars)
VARselect(uschange_train, lag.max=8, type="const",season=4)
library(vars)
VARselect(uschange_train, lag.max=8, type="const",season=4)
var<-VAR(uschange_train, p=5, )
summary(var)
fcst <-forecast(var, h=8)
plot(fcst, xlab="Year")
library(vars)
VARselect(uschange_train, lag.max=8, type="const",season=4)
var<-VAR(uschange_train, p=10, )
summary(var)
fcst <-forecast(var, h=8)
plot(fcst, xlab="Year")
library(vars)
VARselect(uschange_train, lag.max=8, type="const",season=4)
var<-VAR(uschange_train, p=3, )
summary(var)
library(vars)
VARselect(uschange_train, lag.max=8, type="const",season=4)
var<-VAR(uschange_train, p=1, )
summary(var)
library(vars)
VARselect(uschange_train, lag.max=8, type="const",season=4)
var<-VAR(uschange_train, p=7, )
summary(var)
library(vars)
VARselect(uschange_train, lag.max=8, type="const",season=4)
var<-VAR(uschange_train, p=6, )
summary(var)
library(vars)
VARselect(uschange_train, lag.max=8, type="const",season=4)
var<-VAR(uschange_train, p=5, )
summary(var)
library(vars)
VARselect(uschange_train, lag.max=8, type="const",season=4)
var<-VAR(uschange_train, p=8, )
summary(var)
fcst <-forecast(var, h=8)
plot(fcst, xlab="Year")
fcst <-forecast(var, h=8)
plot(fcst, xlab="Year")
serial.test(var, lags.pt=10, type="PT.asymptotic")
uschange_test
library("Metrics")
rmse(uschange_test[,1], fcst$forecast$Consumption$mean)
rmse(uschange_test[,2], fcst$forecast$Income$mean)
rmse(uschange_test[,3], fcst$forecast$Production$mean)
rmse(uschange_test[,4], fcst$forecast$Savings$mean)
rmse(uschange_test[,5], fcst$forecast$Unemployment$mean)
uschange_test
mod1=auto.arima(uschange_train[,1])
pred1=forecast(mod1,h =8)
pred1
uschange_train
uschange_train = window(uschange, start=c(1970), end=c(2015))
uschange_test = window(uschange, start=c(2016))
uschange_train
uschange_train = window(uschange, start=c(1970), end=c(2015, 4), freq=4)
uschange_test = window(uschange, start=c(2016))
uschange_train
fcst <-forecast(var, h=8)
plot(fcst, xlab="Year")
serial.test(var, lags.pt=10, type="PT.asymptotic")
library(vars)
VARselect(uschange_train, lag.max=8, type="const",season=4)
var<-VAR(uschange_train, p=8, )
summary(var)
library(vars)
VARselect(uschange_train, lag.max=8, type="const",season=4)
var<-VAR(uschange_train, p=3, )
summary(var)
library("Metrics")
rmse(uschange_test[,1], fcst$forecast$Consumption$mean)
rmse(uschange_test[,2], fcst$forecast$Income$mean)
rmse(uschange_test[,3], fcst$forecast$Production$mean)
rmse(uschange_test[,4], fcst$forecast$Savings$mean)
rmse(uschange_test[,5], fcst$forecast$Unemployment$mean)
mod1=auto.arima(uschange_train[,1])
pred1=forecast(mod1,h =8)
pred1
uschange_test
mod1=auto.arima(uschange_train[,1])
pred1=forecast(mod1,h =3)
pred1
mod1=auto.arima(uschange_train[,1])
pred1=forecast(mod1,h =3)
mod2=auto.arima(uschange_train[,2])
pred2=forecast(mod2,h =3)
mod3=auto.arima(uschange_train[,3])
pred3=forecast(mod3,h =3)
mod4=auto.arima(uschange_train[,3])
pred4=forecast(mod4,h =3)
mod5=auto.arima(uschange_train[,3])
pred5=forecast(mod5,h =3)
rmse(uschange_test[,1], pred1$mean)
rmse(uschange_test[,2], pred2$mean)
rmse(uschange_test[,3], pred1$mean)
rmse(uschange_test[,4], pred2$mean)
rmse(uschange_test[,5], pred2$mean)
mod1=auto.arima(uschange_train[,1], lambda="auto")
pred1=forecast(mod1,h =3)
mod2=auto.arima(uschange_train[,2], lambda="auto")
pred2=forecast(mod2,h =3)
mod3=auto.arima(uschange_train[,3], lambda="auto")
pred3=forecast(mod3,h =3)
mod4=auto.arima(uschange_train[,3], lambda="auto")
pred4=forecast(mod4,h =3)
mod5=auto.arima(uschange_train[,3], lambda="auto")
pred5=forecast(mod5,h =3)
rmse(uschange_test[,1], pred1$mean)
rmse(uschange_test[,2], pred2$mean)
rmse(uschange_test[,3], pred1$mean)
rmse(uschange_test[,4], pred2$mean)
rmse(uschange_test[,5], pred2$mean)
library("Metrics")
rmse(us_test[,1], fcst$forecast$consumption$mean)
install.packages("fpp")
library(fpp)
library(fpp2)
data(usconsumption)
autoplot(usconsumption)
#install.packages("fpp")
library(fpp)
library(fpp2)
data(usconsumption)
autoplot(usconsumption)
#install.packages("vars")
library(vars)
VARselect(usconsumption, lag.max=8, type="const",season=4)
var<-VAR(usconsumption, p=5, )
summary(var)
fcst<-forecast(var, h=8)
plot(fcst)
library("Metrics")
rmse(us_test[,1], fcst$forecast$consumption$mean)
rmse(us_test[,2], fcst$forecast$income$mean)
us_app
us_test
fcst$forecast$consumption$mean
us_test[,1]
us_test[,2]
fcst$forecast$income$mean
us_test[,2]
rmse(us_test[,2], fcst$forecast$income$mean)
us_test[,2]
fcst$forecast$income$mean
setwd("/Users/emisohpi/Desktop/DSTI/TimeSeries")
library(fpp2)
autoplot(uschange)
fit=tslm(Consumption~Income+Production+Unemployment+Savings, data=uschange)
summary(fit)
fit=Arima(uschange[,"Consumption"],xreg=uschange[,"Income"], order=c(1,0,2))
summary(fit)
checkresiduals(fit, test="LB")
# Xreg = income
autoplot(forecast(fit, xreg=rep(mean(uschange[,2]), 4)))
setwd("/Users/emisohpi/Desktop/DSTI/High Dimensional Data")
#install.packages("mclust")
library(mclust)
?Mclust
data(swiss)
out=Mclust(swiss, G= 3)
plot(swiss, col=out$classification)
data(swiss)
out=Mclust(swiss, G= 3)
plot(swiss, col=out$classification)
data(swiss)
out=Mclust(swiss)
plot(swiss, col=out$classification)
out$parameters
out5 = kmeans(swiss, centers=3, nstart=10)
plot(swiss, col=out5$cluster, pch=19)
out$loglik
library(class)
?hclust
D = dist(swiss)
par(mfrow=c(2,2))
hc1 = hclust(D, method="complete"); plot(hc1)
hc2 = hclust(D, method="single"); plot(hc2)
hc3 = hclust(D, method="centroid"); plot(hc3)
hc4 = hclust(D, method="ward.D2");plot(hc4)
# Comparison with kmeans and hclust
par(mfrow=c(1,3))
hc = hclust(D, method="signle"); out.hc=cutree(hc, 4)
# Comparison with kmeans and hclust
par(mfrow=c(1,3))
hc = hclust(D, method="single"); out.hc=cutree(hc, 4)
plot(swiss[,c(5,2)]), col=out.hc, pch=19, main="HC(single)")
# Comparison with kmeans and hclust
par(mfrow=c(1,3))
hc = hclust(D, method="single"); out.hc=cutree(hc, 4)
plot(swiss[c(5,2)]), col=out.hc, pch=19, main="HC(single)")
out5 = kmeans(swiss, centers=3, nstart=10)
plot(swiss, col=out5$cluster, pch=19)
library(class)
?hclust
D = dist(swiss)
par(mfrow=c(2,2))
hc1 = hclust(D, method="complete"); plot(hc1)
hc2 = hclust(D, method="single"); plot(hc2)
hc3 = hclust(D, method="centroid"); plot(hc3)
hc4 = hclust(D, method="ward.D2");plot(hc4)
# Comparison with kmeans and hclust
par(mfrow=c(1,3))
hc = hclust(D, method="single"); out.hc=cutree(hc, 4)
plot(swiss[,c(5,2)]), col=out.hc, pch=19, main="HC(single)")
# Comparison with kmeans and hclust
par(mfrow=c(1,3))
hc = hclust(D, method="single"); out.hc=cutree(hc, 4)
plot(swiss[,c(5,2)], col=out.hc, pch=19, main="HC(single)")
out.km = kmeans(swiss, centers=3, nstart=10)
plot(swiss[,c(5,2)], col=out.km$cluster, pch=19, cex=3, main="kmeans")
plot(swiss[,c(5,2)], col=out$class)
# Comparison with kmeans and hclust
par(mfrow=c(1,3))
hc = hclust(D, method="single"); out.hc=cutree(hc, 4)
plot(swiss[,c(5,2)], col=out.hc, pch=19, main="HC(single)")
out.km = kmeans(swiss, centers=3, nstart=10)
plot(swiss[,c(5,2)], col=out.km$cluster, pch=19, cex=3, main="kmeans")
plot(swiss[,c(5,2)], col=out$class)
# Comparison with kmeans and hclust
par(mfrow=c(1,3))
hc = hclust(D, method="single"); out.hc=cutree(hc, 4)
plot(swiss[,c(5,2)], col=out.hc, pch=19, main="HC(single)")
out.km = kmeans(swiss, centers=3, nstart=10)
plot(swiss[,c(5,2)], col=out.km$cluster, pch=19, cex=3, main="kmeans")
plot(swiss[,c(5,2)], col=out$class, phc=19, cex=3, main="GMM+EM algorithm")
# Comparison with kmeans and hclust
par(mfrow=c(1,3))
hc = hclust(D, method="single"); out.hc=cutree(hc, 4)
plot(swiss[,c(5,2)], col=out.hc, pch=19, cex=3, main="HC(single)")
out.km = kmeans(swiss, centers=3, nstart=10)
plot(swiss[,c(5,2)], col=out.km$cluster, pch=19, cex=3, main="kmeans")
plot(swiss[,c(5,2)], col=out$class, phc=19, cex=3, main="GMM+EM algorithm")
swiss[,c(5,2)]
out.km
out.km$cluster
install.packages("mclust")
library(mclust)
data(swiss)
out = Mclust(swiss, G=1:5, modelNames="VVV")
plot(out, what="BIC")
install.packages("mclust")
out = Mclust(swiss, G=1:5)
#install.packages("mclust")
library(mclust)
data(swiss)
out = Mclust(swiss, G=1:5, modelNames="VVV")
plot(out, what="BIC")
out = Mclust(swiss, G=1:5)
plot(out, what="BIC")
plot(out, what="classification")
plot(out, what="uncertainty")
round(out$z, 15)
out$z
